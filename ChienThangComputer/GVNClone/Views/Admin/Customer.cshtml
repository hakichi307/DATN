@model IEnumerable<GVNClone.ThanhVien>
@{
    ViewBag.Title = "Customer";
    Layout = "~/Views/Layout/_AdminLayout.cshtml";
}
<style>
    .lst-member #example-table_wrapper {
        border: 1px solid #ddd;
        padding-top: 25px;
        padding-bottom: 25px;
        border-top: none;
    }
</style>
<div class="ibox lst-member">
    <div class="ibox-head">
        <div class="ibox-title">Danh sách thành viên</div>
    </div>
    <div class="ibox-body">
        <ul class="nav nav-tabs mb-0">
            <li class="nav-item">
                <a class="nav-link" href="@Url.Action("Admin","Admin")">Admin</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active font-weight-bold" href="@Url.Action("Customer","Admin")">Khách hàng</a>
            </li>
        </ul>
        <table class="table table-striped table-bordered table-hover" id="example-table" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>Tên hiển thị</th>
                    <th>Mật khẩu</th>
                    <th>Họ tên</th>
                    <th>Địa chỉ</th>
                    <th>Số điện thoại</th>
                    <th>Email</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th>Tên hiển thị</th>
                    <th>Mật khẩu</th>
                    <th>Họ tên</th>
                    <th>Địa chỉ</th>
                    <th>Số điện thoại</th>
                    <th>Email</th>
                    <th>Hành động</th>
                </tr>
            </tfoot>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.TaiKhoan</td>
                        <td>@item.MatKhau</td>
                        <td>@item.HoTen</td>
                        <td>@item.DiaChi</td>
                        <td>@item.SoDienThoai</td>
                        <td>@item.Email</td>
                        <td>
                            <a href="@Url.Action("EditMember", "Admin", new { @id = item.MaTV })" class="btn btn-info" data-toggle="tooltip" data-placement="top" title="Edit">Chỉnh sửa</a>
                            <button class="btn btn-danger btn-xs btn-delete-member" data-id="@item.MaTV" data-toggle="tooltip" data-placement="top" title="Xoá">
                                <i class="fa fa-trash font-16" style="cursor:pointer"></i>
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $(".btn-delete-member").on("click", function () {
            var memberId = $(this).data("id");
            Swal.fire({
                title: "Question",
                text: "Bạn có chắc chắn muốn xoá thành viên này không?",
                icon: "question",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Confirm",
            }).then(function (result) {
                if (result.isConfirmed) {
                    // Gọi hành động xóa thành viên từ JavaScript
                    $.ajax({
                        type: "POST",
                        url: "/Admin/DeleteMember", // Đặt URL trực tiếp tại đây
                        data: { id: memberId },
                        success: function (response) {
                            // Xử lý phản hồi sau khi xóa thành viên thành công (nếu cần)
                            // Ví dụ: cập nhật giao diện người dùng hoặc hiển thị thông báo
                            Swal.fire({
                                title: 'Success',
                                text: 'Thành viên đã được xoá khỏi hệ thống',
                                icon: 'success'
                            }).then(function () {
                                location.reload(); // Tải lại trang để cập nhật dữ liệu
                            })
                        },
                        error: function () {
                            // Xử lý lỗi nếu có
                            Swal.fire({
                                title: 'Error',
                                text: 'Có điều gì đó không ổn! Hãy thử lại',
                                icon: 'error',
                            })
                        }
                    });
                }
            })
        });
    });
</script>



